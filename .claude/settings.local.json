{
  "permissions": {
    "allow": [
      "Bash(git push)",
      "Bash(python -m json.tool:*)",
      "Bash(git commit:*)",
      "Bash(git remote set-url:*)",
      "WebFetch(domain:github.com)",
      "Bash(brew install:*)",
      "Bash(railway --version:*)",
      "Bash(railway login:*)",
      "Bash(railway status:*)",
      "Bash(railway logs:*)",
      "Bash(railway service:*)",
      "Bash(railway variables:*)",
      "Bash(timeout 10 railway logs:*)",
      "Bash(railway domain:*)",
      "Bash(chmod:*)",
      "Bash(git add:*)",
      "Bash(ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && rm -f .env.prod .env.prod.db && git pull && ./deploy-to-droplet.sh\")",
      "Bash(cat:*)",
      "Bash(ssh:*)",
      "Bash(ssh-keygen:*)",
      "Bash(curl:*)",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cat ~/scaling-engine/.env.prod | grep DJANGO_ALLOWED_HOSTS\")",
      "Bash(git pull:*)",
      "mcp__figma-desktop__get_screenshot",
      "mcp__figma-desktop__get_design_context",
      "Bash(mkdir:*)",
      "Bash(docker-compose:*)",
      "Bash(docker start:*)",
      "Bash(lsof:*)",
      "Bash(docker ps:*)",
      "Bash(docker exec:*)",
      "Bash(docker run:*)",
      "Bash(docker logs:*)",
      "Bash(docker restart:*)",
      "Bash(docker cp:*)",
      "Bash(docker stop:*)",
      "Bash(docker rm:*)",
      "WebFetch(domain:radioreads.fun)",
      "Bash(git push:*)",
      "Bash(docker system prune:*)",
      "Bash(git rm:*)",
      "Bash(docker volume:*)",
      "Bash(psql:*)",
      "Bash(docker builder prune:*)",
      "Bash(docker pull:*)",
      "Bash(git fetch:*)",
      "Bash(ls:*)",
      "Bash(bun run dev:*)",
      "Bash(docker inspect:*)",
      "Bash(gh workflow:*)",
      "Bash(gh run list:*)",
      "Bash(gh run view:*)",
      "WebFetch(domain:www.npmjs.com)",
      "mcp__droplet__remote-ssh",
      "mcp__github__list_commits",
      "Bash(claude mcp list:*)",
      "Bash(echo $GITHUB_TOKEN)",
      "Bash(gh auth status:*)",
      "Bash(npm view:*)",
      "mcp__github__get_file_contents",
      "Bash(claude mcp add --transport http github https://api.githubcopilot.com/mcp -H \"Authorization: Bearer $GITHUB_TOKEN\" -s user)",
      "Bash(claude mcp remove:*)",
      "Bash(git checkout:*)",
      "Bash(npx tsc:*)",
      "Bash(npm run build:*)",
      "Bash(git restore:*)",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py regenerate_book_slugs\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py download_book_covers --limit 20\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py shell -c \"\"from stations.models import Book; print(Book.objects.exclude(cover_image='''').count(), ''books with covers''); print(Book.objects.filter(cover_image='''').count(), ''books without covers'')\"\"\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py shell -c \"\"from stations.models import Book; b = Book.objects.exclude(cover_image='''').first(); print(''cover_image:'', b.cover_image); print(''type:'', type(b.cover_image))\"\"\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py generate_book_blurbs\")",
      "Bash(python3:*)",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py shell -c \"\"\nfrom stations.models import Book\n# Clear malformed cover_image values that contain URLs\ncleared = 0\nfor book in Book.objects.all():\n    if book.cover_image and (''http'' in str(book.cover_image) or ''unsplash'' in str(book.cover_image)):\n        book.cover_image = ''''\n        book.save(update_fields=[''cover_image''])\n        cleared += 1\nprint(f''Cleared {cleared} malformed cover_image values'')\n\"\"\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py download_book_covers --limit 30\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py shell -c \"\"\nfrom stations.utils import fetch_book_cover\nurl = fetch_book_cover(''Demon Copperhead'', ''Barbara Kingsolver'')\nprint(''URL:'', url)\n\"\"\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py shell -c \"\"\nimport tempfile\nimport urllib.request\nimport os\nfrom django.core.files import File\nfrom stations.models import Book\nfrom stations.utils import fetch_book_cover\n\nbook = Book.objects.get(title=''''Demon Copperhead'''')\nprint(''''Book:'''', book.title, book.slug)\n\ncover_url = fetch_book_cover(book.title, book.author)\nprint(''''Cover URL:'''', cover_url)\n\nif cover_url:\n    try:\n        with tempfile.NamedTemporaryFile(delete=False, suffix=''''.jpg'''') as tmp_file:\n            request = urllib.request.Request(\n                cover_url,\n                headers={''''User-Agent'''': ''''Mozilla/5.0 (compatible; RadioReads/1.0)''''}\n            )\n            with urllib.request.urlopen(request, timeout=30) as response:\n                tmp_file.write(response.read())\n                tmp_path = tmp_file.name\n                print(''''Downloaded to:'''', tmp_path)\n        \n        filename = f''''{book.slug}.jpg''''\n        print(''''Saving as:'''', filename)\n        with open(tmp_path, ''''rb'''') as f:\n            book.cover_image.save(filename, File(f), save=True)\n        print(''''Saved! cover_image:'''', book.cover_image)\n        os.unlink(tmp_path)\n    except Exception as e:\n        print(''''Error:'''', e)\n        import traceback\n        traceback.print_exc()\n\"\"\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web chmod -R 777 /home/app/web/media && docker-compose -f docker-compose.prod.yml exec -T web mkdir -p /home/app/web/media/covers && docker-compose -f docker-compose.prod.yml exec -T web chmod -R 777 /home/app/web/media\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"docker exec -u root scaling-engine-web-1 mkdir -p /home/app/web/media/covers && docker exec -u root scaling-engine-web-1 chown -R app:app /home/app/web/media && docker exec -u root scaling-engine-web-1 chmod -R 755 /home/app/web/media\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"docker ps --format ''{{.Names}}''\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"docker exec -u root scaling-engine_web_1 mkdir -p /home/app/web/media/covers && docker exec -u root scaling-engine_web_1 chown -R app:app /home/app/web/media && docker exec -u root scaling-engine_web_1 chmod -R 755 /home/app/web/media\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py download_book_covers\")",
      "Bash(python manage.py makemigrations:*)",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml ps\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml up -d db redis celery-beat\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml down && docker-compose -f docker-compose.prod.yml up -d\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py showmigrations stations | tail -5\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py shell -c \"\"\nfrom stations.models import Book\nfrom stations.ai_utils import generate_micro_synopsis\n\nbooks = Book.objects.all()\nprint(f''Regenerating micro synopses for {books.count()} books...'')\nprint()\n\nsuccess = 0\nfailed = 0\n\nfor book in books:\n    synopsis = generate_micro_synopsis(book.title, book.author, book.description)\n    if synopsis:\n        book.micro_synopsis = synopsis\n        book.save(update_fields=[''micro_synopsis''])\n        print(f''  {book.title}: \\\"\"{synopsis}\\\"\" ({len(synopsis)} chars)'')\n        success += 1\n    else:\n        print(f''  {book.title}: FAILED'')\n        failed += 1\n\nprint()\nprint(f''Completed: {success} success, {failed} failed'')\n\"\"\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py shell -c \"\"\nfrom stations.models import Book\n# Show some good examples\ngood_examples = Book.objects.filter(micro_synopsis__len__gte=35, micro_synopsis__len__lte=40).order_by(''?'')[:5]\nprint(''Sample micro synopses (35-40 chars):'')\nfor b in Book.objects.all()[:10]:\n    print(f''  {b.title}: \\\"\"{b.micro_synopsis}\\\"\" ({len(b.micro_synopsis)} chars)'')\n\"\"\")",
      "Bash(sshpass -pE4wTHGSv5pxY2rs ssh -o StrictHostKeyChecking=no root@159.65.18.16 \"cd ~/scaling-engine && docker-compose -f docker-compose.prod.yml exec -T web python manage.py shell -c \"\"\nfrom stations.models import Book\nprint(''Sample micro synopses:'')\nfor b in Book.objects.all()[:10]:\n    print(f''  {b.title}: \\\"\"{b.micro_synopsis}\\\"\" ({len(b.micro_synopsis)} chars)'')\n\"\"\")",
      "Bash(gh run:*)"
    ],
    "deny": [],
    "ask": []
  }
}
